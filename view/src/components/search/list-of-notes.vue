<template>
    <div class="container">
        <div class="item" v-for="item in process_list(noteslist)" :key="item">
           <div class="begin">
                <svg class="note-symbol-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 95.6055 95.6543">
                    <g>
                        <path class="note-symbol-path" d="M21.6797 29.1016C21.6797 30.9082 23.1445 32.373 25 32.373L70.6055 32.373C72.4121 32.373 73.9258 30.9082 73.9258 29.1016C73.9258 27.2949 72.4121 25.7812 70.6055 25.7812L25 25.7812C23.1445 25.7812 21.6797 27.2949 21.6797 29.1016ZM21.6797 47.8516C21.6797 49.6582 23.1445 51.123 25 51.123L70.6055 51.123C72.4121 51.123 73.9258 49.6582 73.9258 47.8516C73.9258 46.0449 72.4121 44.5312 70.6055 44.5312L25 44.5312C23.1445 44.5312 21.6797 46.0449 21.6797 47.8516ZM21.6797 66.6016C21.6797 68.4082 23.1445 69.9219 25 69.9219L54.9805 69.9219C56.7871 69.9219 58.3008 68.4082 58.3008 66.6016C58.3008 64.7949 56.7871 63.3301 54.9805 63.3301L25 63.3301C23.1445 63.3301 21.6797 64.7949 21.6797 66.6016ZM3.90625 31.1523C6.49414 31.1523 7.86133 29.6875 7.86133 27.1484L7.86133 15.625C7.86133 10.5469 10.5469 7.95898 15.4297 7.95898L27.2461 7.95898C29.834 7.95898 31.25 6.54297 31.25 4.00391C31.25 1.46484 29.834 0.0976562 27.2461 0.0976562L15.332 0.0976562C5.12695 0.0976562 0 5.12695 0 15.1855L0 27.1484C0 29.6875 1.41602 31.1523 3.90625 31.1523ZM91.6504 31.1523C94.2383 31.1523 95.6055 29.6875 95.6055 27.1484L95.6055 15.1855C95.6055 5.12695 90.4785 0.0976562 80.2734 0.0976562L68.3105 0.0976562C65.7715 0.0976562 64.3555 1.46484 64.3555 4.00391C64.3555 6.54297 65.7715 7.95898 68.3105 7.95898L80.127 7.95898C84.9609 7.95898 87.7441 10.5469 87.7441 15.625L87.7441 27.1484C87.7441 29.6875 89.1602 31.1523 91.6504 31.1523ZM15.332 95.6543L27.2461 95.6543C29.834 95.6543 31.25 94.2383 31.25 91.748C31.25 89.209 29.834 87.793 27.2461 87.793L15.4297 87.793C10.5469 87.793 7.86133 85.2051 7.86133 80.127L7.86133 68.6035C7.86133 66.0156 6.44531 64.5996 3.90625 64.5996C1.36719 64.5996 0 66.0156 0 68.6035L0 80.5176C0 90.625 5.12695 95.6543 15.332 95.6543ZM68.3105 95.6543L80.2734 95.6543C90.4785 95.6543 95.6055 90.5762 95.6055 80.5176L95.6055 68.6035C95.6055 66.0156 94.1895 64.5996 91.6504 64.5996C89.1113 64.5996 87.7441 66.0156 87.7441 68.6035L87.7441 80.127C87.7441 85.2051 84.9609 87.793 80.127 87.793L68.3105 87.793C65.7715 87.793 64.3555 89.209 64.3555 91.748C64.3555 94.2383 65.7715 95.6543 68.3105 95.6543Z"/>
                    </g>
                </svg>
           </div>
           <div class="filename" @click="$emit('renderfile', item.filename)">{{ item.vis }}</div>
           <div class="end">
                <svg v-if="!checked" @click="checked = !checked" class="favorite-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 108.438 110.596">
                    <g>
                        <path class="star-outline" d="M20.8055 102.734C22.8074 104.297 25.3465 103.76 28.3738 101.562L54.2039 82.5684L80.0828 101.562C83.1102 103.76 85.6004 104.297 87.6512 102.734C89.6531 101.221 90.0926 98.7305 88.8719 95.166L78.6668 64.7949L104.741 46.0449C107.768 43.8965 108.989 41.6504 108.208 39.209C107.427 36.8652 105.132 35.6934 101.372 35.7422L69.3895 35.9375L59.6727 5.41992C58.5008 1.80664 56.743 0 54.2039 0C51.7137 0 49.9559 1.80664 48.784 5.41992L39.0672 35.9375L7.08477 35.7422C3.32501 35.6934 1.03008 36.8652 0.248834 39.209C-0.581244 41.6504 0.688287 43.8965 3.71563 46.0449L29.7898 64.7949L19.5848 95.166C18.3641 98.7305 18.8035 101.221 20.8055 102.734ZM27.8367 93.0664C27.7391 92.9688 27.7879 92.9199 27.8367 92.627L37.5535 64.6973C38.2371 62.793 37.8465 61.2793 36.1375 60.1074L11.8211 43.3105C11.577 43.1641 11.5281 43.0664 11.577 42.9199C11.6258 42.7734 11.7234 42.7734 12.0164 42.7734L41.5574 43.3105C43.5594 43.3594 44.8289 42.5293 45.4637 40.5273L53.9598 12.2559C54.0086 11.9629 54.1063 11.8652 54.2039 11.8652C54.3504 11.8652 54.4481 11.9629 54.4969 12.2559L62.993 40.5273C63.6277 42.5293 64.8973 43.3594 66.8992 43.3105L96.4402 42.7734C96.7332 42.7734 96.8309 42.7734 96.8797 42.9199C96.9285 43.0664 96.8309 43.1641 96.6356 43.3105L72.3191 60.1074C70.6102 61.2793 70.2195 62.793 70.9031 64.6973L80.6199 92.627C80.6688 92.9199 80.7176 92.9688 80.6199 93.0664C80.5223 93.2129 80.3758 93.1152 80.1805 92.9688L56.6941 75.0488C55.1316 73.8281 53.325 73.8281 51.7625 75.0488L28.2762 92.9688C28.0809 93.1152 27.9344 93.2129 27.8367 93.0664Z"/>
                    </g>
                </svg>
                <svg v-if="checked" @click="checked = !checked" class="favorite-svg" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 108.438 110.596">
                    <g>
                        <path class="star-fill" d="M20.8055 102.734C22.8074 104.297 25.3465 103.76 28.3738 101.562L54.2039 82.5684L80.0828 101.562C83.1102 103.76 85.6004 104.297 87.6512 102.734C89.6531 101.221 90.0926 98.7305 88.8719 95.166L78.6668 64.7949L104.741 46.0449C107.768 43.8965 108.989 41.6504 108.208 39.209C107.427 36.8652 105.132 35.6934 101.372 35.7422L69.3895 35.9375L59.6727 5.41992C58.5008 1.80664 56.743 0 54.2039 0C51.7137 0 49.9559 1.80664 48.784 5.41992L39.0672 35.9375L7.08477 35.7422C3.32501 35.6934 1.03008 36.8652 0.248834 39.209C-0.581244 41.6504 0.688287 43.8965 3.71563 46.0449L29.7898 64.7949L19.5848 95.166C18.3641 98.7305 18.8035 101.221 20.8055 102.734Z"/>
                    </g>
                </svg>
           </div>
        </div>
    </div>
</template>

<script>
function matches(needle, haystack) {
    let needle_index = 0
    for (let i = 0; i < haystack.length && needle_index < needle.length; i++) {
        if (haystack[i] == needle[needle_index]) {
            needle_index += 1
        }
    }
    return needle_index == needle.length
}

export default{
    props: {
        noteslist: Object,
        query: String,
    },
    data() {
        return {
            checked: false,
        }
    },
    emits: ["renderfile"],
    methods: {
        process_list(list) {
            return list.map((item) => item['vis'] = item.filename.slice(0, -3))
                       .filter((item) => matches(this.query, item.vis))
        }
    }
}
</script>

<style scoped>
* {
    --star-symbol-width: 20px;
    --note-symbol-width: 10px;
}
.container{
    padding-top: 15px;
    padding-bottom: 15px;
    display: grid;
}
.item {
  height: 50px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}
.filename {
  flex-grow: 1;
  font-size: 16px;
  height: 100%;
  display: flex;
  align-items: center;
}
.end {
    width: 30px;
}
.favorite-svg {
    margin: auto;
    height: var(--star-symbol-width);
    width: var(--star-symbol-width);
}
.star-outline {
    fill: var(--icon-grey);
}
.star-fill {
    fill: var(--yellow);
}
.begin {
    width: 15px;
}
.note-symbol-path {
    fill: var(--icon-grey);
}
.note-symbol-svg {
    margin: auto 0;
    height: var(--note-symbol-width);
    width: var(--note-symbol-width);
}
</style>